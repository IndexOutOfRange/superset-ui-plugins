(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{1261:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(0),o=n.n(i),a=n(1),r=n.n(a);function s(){return(s=Object.assign||function(t){for(var e,n=1;n<arguments.length;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c(t,e){var n=function(n){function i(t){var e;return u(l(e=n.call(this,t)||this),"container",void 0),e.setContainerRef=e.setContainerRef.bind(l(e)),e}!function(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}(i,n);var o=i.prototype;return o.componentDidMount=function(){this.execute()},o.componentDidUpdate=function(){this.execute()},o.componentWillUnmount=function(){this.container=void 0,e&&e.componentWillUnmount&&e.componentWillUnmount.bind(this)()},o.setContainerRef=function(t){this.container=t},o.execute=function(){this.container&&t(this.container,this.props)},o.render=function(){var t=this.props,e=t.id,n=t.className;return r.a.createElement("div",{id:e,className:n,ref:this.setContainerRef})},i}(r.a.Component);u(n,"propTypes",{id:o.a.string,className:o.a.string});var i=n;return t.displayName&&(i.displayName=t.displayName),t.propTypes&&(i.propTypes=s({},i.propTypes,{},t.propTypes)),t.defaultProps&&(i.defaultProps=t.defaultProps),n}},1264:function(t,e,n){t.exports=n(1314)},1282:function(t,e,n){t.exports=n(1283)},1283:function(t,e,n){var i=n(1284);t.exports=i},1284:function(t,e,n){var i=n(1285),o=Array.prototype;t.exports=function(t){var e=t.reverse;return t===o||t instanceof Array&&e===o.reverse?i:e}},1285:function(t,e,n){n(1286);var i=n(61);t.exports=i("Array").reverse},1286:function(t,e,n){"use strict";var i=n(31),o=n(211),a=[].reverse,r=[1,2];i({target:"Array",proto:!0,forced:String(r)===String(r.reverse())},{reverse:function(){return o(this)&&(this.length=this.length),a.call(this)}})},1312:function(t,e,n){t.exports=n(1313)},1313:function(t,e,n){var i=n(619);t.exports=i},1314:function(t,e,n){var i=n(1315);t.exports=i},1315:function(t,e,n){var i=n(1316),o=Array.prototype;t.exports=function(t){var e=t.fill;return t===o||t instanceof Array&&e===o.fill?i:e}},1316:function(t,e,n){n(1317);var i=n(61);t.exports=i("Array").fill},1317:function(t,e,n){var i=n(31),o=n(1318),a=n(290);i({target:"Array",proto:!0},{fill:o}),a("fill")},1318:function(t,e,n){"use strict";var i=n(111),o=n(383),a=n(125);t.exports=function(t){for(var e=i(this),n=a(e.length),r=arguments.length,s=o(r>1?arguments[1]:void 0,n),l=r>2?arguments[2]:void 0,u=void 0===l?n:o(l,n);u>s;)e[s++]=t;return e}},1341:function(t,e,n){t.exports=n(1370)},1365:function(t,e,n){t.exports=n(1366)},1366:function(t,e,n){var i=n(1367);t.exports=i},1367:function(t,e,n){var i=n(1368),o=Array.prototype;t.exports=function(t){var e=t.splice;return t===o||t instanceof Array&&e===o.splice?i:e}},1368:function(t,e,n){n(1369);var i=n(61);t.exports=i("Array").splice},1369:function(t,e,n){"use strict";var i=n(31),o=n(383),a=n(289),r=n(125),s=n(111),l=n(385),u=n(299),c=n(218),h=n(100),m=c("splice"),g=h("splice",{ACCESSORS:!0,0:0,1:2}),d=Math.max,p=Math.min;i({target:"Array",proto:!0,forced:!m||!g},{splice:function(t,e){var n,i,c,h,m,g,f=s(this),D=r(f.length),b=o(t,D),w=arguments.length;if(0===w?n=i=0:1===w?(n=0,i=D-b):(n=w-2,i=p(d(a(e),0),D-b)),D+n-i>9007199254740991)throw TypeError("Maximum allowed length exceeded");for(c=l(f,i),h=0;h<i;h++)(m=b+h)in f&&u(c,h,f[m]);if(c.length=i,n<i){for(h=b;h<D-i;h++)g=h+n,(m=h+i)in f?f[g]=f[m]:delete f[g];for(h=D;h>D-i+n;h--)delete f[h-1]}else if(n>i)for(h=D-i;h>b;h--)g=h+n-1,(m=h+i-1)in f?f[g]=f[m]:delete f[g];for(h=0;h<n;h++)f[h+b]=arguments[h+2];return f.length=D-i+n,c}})},1370:function(t,e,n){n(286);var i=n(1371),o=n(175),a=Array.prototype,r={DOMTokenList:!0,NodeList:!0};t.exports=function(t){var e=t.keys;return t===a||t instanceof Array&&e===a.keys||r.hasOwnProperty(o(t))?i:e}},1371:function(t,e,n){var i=n(1372);t.exports=i},1372:function(t,e,n){n(394);var i=n(61);t.exports=i("Array").keys},1643:function(t,e,n){var i=n(283),o=n(1644);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var a={insert:"head",singleton:!1},r=(i(o,a),o.locals?o.locals:{});t.exports=r},1644:function(t,e,n){(e=n(284)(!1)).push([t.i,"/* [LICENSE TBD] */\n/* Cal-HeatMap CSS */\n\n.cal-heatmap-container {\n  display: block;\n}\n\n.cal-heatmap-container .graph-label {\n  fill: #999;\n  font-size: 10px;\n}\n\n.cal-heatmap-container .graph,\n.cal-heatmap-container .graph-legend rect {\n  shape-rendering: crispedges;\n}\n\n.cal-heatmap-container .graph-rect {\n  fill: #ededed;\n}\n\n.cal-heatmap-container .graph-subdomain-group rect:hover {\n  stroke: #000;\n  stroke-width: 1px;\n}\n\n.cal-heatmap-container .subdomain-text {\n  font-size: 8px;\n  fill: #999;\n  pointer-events: none;\n}\n\n.cal-heatmap-container .hover_cursor:hover {\n  cursor: pointer;\n}\n\n.cal-heatmap-container .qi {\n  background-color: #999;\n  fill: #999;\n}\n\n/*\nRemove comment to apply this style to date with value equal to 0\n.q0\n{\n  background-color: #fff;\n  fill: #fff;\n  stroke: #ededed\n}\n*/\n\n.cal-heatmap-container .q1 {\n  background-color: #dae289;\n  fill: #dae289;\n}\n\n.cal-heatmap-container .q2 {\n  background-color: #cedb9c;\n  fill: #9cc069;\n}\n\n.cal-heatmap-container .q3 {\n  background-color: #b5cf6b;\n  fill: #669d45;\n}\n\n.cal-heatmap-container .q4 {\n  background-color: #637939;\n  fill: #637939;\n}\n\n.cal-heatmap-container .q5 {\n  background-color: #3b6427;\n  fill: #3b6427;\n}\n\n.cal-heatmap-container rect.highlight {\n  stroke: #444;\n  stroke-width: 1;\n}\n\n.cal-heatmap-container text.highlight {\n  fill: #444;\n}\n\n.cal-heatmap-container rect.highlight-now {\n  stroke: red;\n}\n\n.cal-heatmap-container text.highlight-now {\n  fill: red;\n  font-weight: 800;\n}\n\n.cal-heatmap-container .domain-background {\n  fill: none;\n  shape-rendering: crispedges;\n}\n\n.ch-tooltip {\n  padding: 10px;\n  background: #222;\n  color: #bbb;\n  font-size: 12px;\n  line-height: 1.4;\n  width: 140px;\n  position: absolute;\n  z-index: 99999;\n  text-align: center;\n  border-radius: 2px;\n  box-shadow: 2px 2px 2px rgba(0, 0, 0, 0.2);\n  display: none;\n  box-sizing: border-box;\n}\n\n.ch-tooltip::after {\n  position: absolute;\n  width: 0;\n  height: 0;\n  border-color: transparent;\n  border-style: solid;\n  content: '';\n  padding: 0;\n  display: block;\n  bottom: -6px;\n  left: 50%;\n  margin-left: -6px;\n  border-width: 6px 6px 0;\n  border-top-color: #222;\n}\n",""]),t.exports=e},1645:function(t,e,n){var i=n(283),o=n(1646);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var a={insert:"head",singleton:!1},r=(i(o,a),o.locals?o.locals:{});t.exports=r},1646:function(t,e,n){(e=n(284)(!1)).push([t.i,'/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * "License"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n\n.superset-legacy-chart-calendar {\n  padding: 10px;\n  position: static !important;\n  overflow: auto !important;\n}\n\n.superset-legacy-chart-calendar .ch-tooltip {\n  margin-left: 20px;\n  margin-top: 5px;\n}\n',""]),t.exports=e},1647:function(t,e,n){var i=n(46),o=n(32),a=n(220),r=n(401),s=n(63).f,l=n(219).f,u=n(402),c=n(392),h=n(621),m=n(77),g=n(33),d=n(112).set,p=n(400),f=n(37)("match"),D=o.RegExp,b=D.prototype,w=/a/g,y=/a/g,v=new D(w)!==w,x=h.UNSUPPORTED_Y;if(i&&a("RegExp",!v||x||g((function(){return y[f]=!1,D(w)!=w||D(y)==y||"/a/i"!=D(w,"i")})))){for(var M=function(t,e){var n,i=this instanceof M,o=u(t),a=void 0===e;if(!i&&o&&t.constructor===M&&a)return t;v?o&&!a&&(t=t.source):t instanceof M&&(a&&(e=c.call(t)),t=t.source),x&&(n=!!e&&e.indexOf("y")>-1)&&(e=e.replace(/y/g,""));var s=r(v?new D(t,e):D(t,e),i?this:b,M);return x&&n&&d(s,{sticky:n}),s},T=function(t){t in M||s(M,t,{configurable:!0,get:function(){return D[t]},set:function(e){D[t]=e}})},N=l(D),S=0;N.length>S;)T(N[S++]);b.constructor=M,M.prototype=b,m(o,"RegExp",M)}p("RegExp")},1648:function(t,e,n){var i=n(283),o=n(1649);"string"==typeof(o=o.__esModule?o.default:o)&&(o=[[t.i,o,""]]);var a={insert:"head",singleton:!1},r=(i(o,a),o.locals?o.locals:{});t.exports=r},1649:function(t,e,n){(e=n(284)(!1)).push([t.i,"/**\n * Licensed to the Apache Software Foundation (ASF) under one\n * or more contributor license agreements.  See the NOTICE file\n * distributed with this work for additional information\n * regarding copyright ownership.  The ASF licenses this file\n * to you under the Apache License, Version 2.0 (the\n * \"License\"); you may not use this file except in compliance\n * with the License.  You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * \"AS IS\" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied.  See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n/* from d3-tip */\n.d3-tip {\n  line-height: 1;\n  padding: 12px;\n  background: rgba(0, 0, 0, 0.8);\n  color: #fff;\n  border-radius: 2px;\n  pointer-events: none;\n  z-index: 1000;\n}\n\n/* Creates a small triangle extender for the tooltip */\n.d3-tip:after {\n  box-sizing: border-box;\n  display: inline;\n  font-size: 10px;\n  width: 100%;\n  line-height: 1;\n  color: rgba(0, 0, 0, 0.8);\n  position: absolute;\n  pointer-events: none;\n}\n\n/* Northward tooltips */\n.d3-tip.n:after {\n  content: '\\25BC';\n  margin: -1px 0 0 0;\n  top: 100%;\n  left: 0;\n  text-align: center;\n}\n\n/* Eastward tooltips */\n.d3-tip.e:after {\n  content: '\\25C0';\n  margin: -4px 0 0 0;\n  top: 50%;\n  left: -8px;\n}\n\n/* Southward tooltips */\n.d3-tip.s:after {\n  content: '\\25B2';\n  margin: 0 0 1px 0;\n  top: -8px;\n  left: 0;\n  text-align: center;\n}\n\n/* Westward tooltips */\n.d3-tip.w:after {\n  content: '\\25B6';\n  margin: -4px 0 0 -1px;\n  top: 50%;\n  left: 100%;\n}\n",""]),t.exports=e},2305:function(t,e,n){"use strict";n.r(e);var i=n(1261),o=n(18),a=n.n(o),r=n(146),s=n.n(r),l=n(52),u=n.n(l),c=n(0),h=n.n(c),m=n(1224),g=n(1195),d=n(419),p=n(371),f=n(282),D=n(1196),b=(n(287),n(1647),n(98),n(19),n(293),n(389),n(1365)),w=n.n(b),y=n(49),v=n.n(y),x=n(1341),M=n.n(x),T=n(210),N=n.n(T),S=n(414),L=n.n(S),k=n(76),_=n.n(k),C=n(173),P=n.n(C),F=n(65),O=n.n(F),A=n(1312),I=n.n(A),R=n(1282),E=n.n(R),H=n(1264),Y=n.n(H),W=n(415),z=(n(1648),n(110)),U=(z=n(110),function(){var t=this;for(var e in t.tip=Object(W.a)().attr("class","d3-tip").direction("n").offset([-5,0]).html((function(e){return"\n      "+t.options.timeFormatter(e.t)+": <strong>"+t.options.valueFormatter(e.v)+"</strong>\n    "})),t.legendTip=Object(W.a)().attr("class","d3-tip").direction("n").offset([-5,0]).html((function(e){return t.options.valueFormatter(e)})),this.allowedDataType=["json","csv","tsv","txt"],this.options={itemSelector:"#cal-heatmap",paintOnLoad:!0,range:12,cellSize:10,cellPadding:2,cellRadius:0,domainGutter:2,domainMargin:[0,0,0,0],valueFormatter:function(t){return t},timeFormatter:function(t){return t},domain:"hour",subDomain:"min",colLimit:null,rowLimit:null,weekStartOnMonday:!0,start:new Date,minDate:null,maxDate:null,data:"",dataType:this.allowedDataType[0],dataPostPayload:null,dataRequestHeaders:null,considerMissingDataAsZero:!1,loadOnInit:!0,verticalOrientation:!1,domainDynamicDimension:!0,label:{position:"bottom",align:"center",offset:{x:0,y:0},rotate:null,width:100,height:null},legend:[10,20,30,40],displayLegend:!0,legendCellSize:10,legendCellPadding:2,legendMargin:[0,0,0,0],legendVerticalPosition:"bottom",legendHorizontalPosition:"left",legendOrientation:"horizontal",legendColors:null,highlight:[],itemName:["item","items"],domainLabelFormat:null,subDomainTitleFormat:{empty:"{date}",filled:"{count} {name} {connector} {date}"},subDomainDateFormat:null,subDomainTextFormat:null,legendTitleFormat:{lower:"less than {min} {name}",inner:"between {down} and {up} {name}",upper:"more than {max} {name}"},animationDuration:500,nextSelector:!1,previousSelector:!1,itemNamespace:"cal-heatmap",tooltip:!1,onClick:null,afterLoad:null,afterLoadNextDomain:null,afterLoadPreviousDomain:null,onComplete:null,afterLoadData:function(t){return t},afterUpdate:null,onMaxDomainReached:null,onMinDomainReached:null},this._domainType={min:{name:"minute",level:10,maxItemNumber:60,defaultRowNumber:10,defaultColumnNumber:6,row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){return Math.floor(e.getMinutes()/t._domainType.min.row(e))},y:function(e){return e.getMinutes()%t._domainType.min.row(e)}},format:{date:"%H:%M, %A %B %-e, %Y",legend:"",connector:"at"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()).getTime()}},hour:{name:"hour",level:20,maxItemNumber:function(e){switch(t.options.domain){case"day":return 24;case"week":return 168;case"month":return 24*(t.options.domainDynamicDimension?t.getDayCountInMonth(e):31)}},defaultRowNumber:6,defaultColumnNumber:function(e){switch(t.options.domain){case"day":return 4;case"week":return 28;case"month":return t.options.domainDynamicDimension?t.getDayCountInMonth(e):31}},row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){return"month"===t.options.domain?t.options.colLimit>0||t.options.rowLimit>0?Math.floor((e.getHours()+24*(e.getDate()-1))/t._domainType.hour.row(e)):Math.floor(e.getHours()/t._domainType.hour.row(e))+4*(e.getDate()-1):"week"===t.options.domain?t.options.colLimit>0||t.options.rowLimit>0?Math.floor((e.getHours()+24*t.getWeekDay(e))/t._domainType.hour.row(e)):Math.floor(e.getHours()/t._domainType.hour.row(e))+4*t.getWeekDay(e):Math.floor(e.getHours()/t._domainType.hour.row(e))},y:function(e){var n=e.getHours();if(t.options.colLimit>0||t.options.rowLimit>0)switch(t.options.domain){case"month":n+=24*(e.getDate()-1);break;case"week":n+=24*t.getWeekDay(e)}return Math.floor(n%t._domainType.hour.row(e))}},format:{date:"%Hh, %A %B %-e, %Y",legend:"%H:00",connector:"at"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()).getTime()}},day:{name:"day",level:30,maxItemNumber:function(e){switch(t.options.domain){case"week":return 7;case"month":return t.options.domainDynamicDimension?t.getDayCountInMonth(e):31;case"year":return t.options.domainDynamicDimension?t.getDayCountInYear(e):366}},defaultColumnNumber:function(e){switch(e=new Date(e),t.options.domain){case"week":return 1;case"month":return t.options.domainDynamicDimension&&!t.options.verticalOrientation?t.getWeekNumber(new Date(e.getFullYear(),e.getMonth()+1,0))-t.getWeekNumber(e)+1:6;case"year":return t.options.domainDynamicDimension?t.getWeekNumber(new Date(e.getFullYear(),11,31))-t.getWeekNumber(new Date(e.getFullYear(),0))+1:54}},defaultRowNumber:7,row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){switch(t.options.domain){case"week":return Math.floor(t.getWeekDay(e)/t._domainType.day.row(e));case"month":return t.options.colLimit>0||t.options.rowLimit>0?Math.floor((e.getDate()-1)/t._domainType.day.row(e)):t.getWeekNumber(e)-t.getWeekNumber(new Date(e.getFullYear(),e.getMonth()));case"year":return t.options.colLimit>0||t.options.rowLimit>0?Math.floor((t.getDayOfYear(e)-1)/t._domainType.day.row(e)):t.getWeekNumber(e)}},y:function(e){var n=t.getWeekDay(e);if(t.options.colLimit>0||t.options.rowLimit>0)switch(t.options.domain){case"year":n=t.getDayOfYear(e)-1;break;case"week":n=t.getWeekDay(e);break;case"month":n=e.getDate()-1}return Math.floor(n%t._domainType.day.row(e))}},format:{date:"%A %B %-e, %Y",legend:"%e %b",connector:"on"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()}},week:{name:"week",level:40,maxItemNumber:54,defaultColumnNumber:function(e){switch(e=new Date(e),t.options.domain){case"year":return t._domainType.week.maxItemNumber;case"month":return t.options.domainDynamicDimension?t.getWeekNumber(new Date(e.getFullYear(),e.getMonth()+1,0))-t.getWeekNumber(e):5}},defaultRowNumber:1,row:function(e){return t.getSubDomainRowNumber(e)},column:function(e){return t.getSubDomainColumnNumber(e)},position:{x:function(e){switch(t.options.domain){case"year":return Math.floor(t.getWeekNumber(e)/t._domainType.week.row(e));case"month":return Math.floor(t.getMonthWeekNumber(e)/t._domainType.week.row(e))}},y:function(e){return t.getWeekNumber(e)%t._domainType.week.row(e)}},format:{date:"%B Week #%W",legend:"%B Week #%W",connector:"in"},extractUnit:function(e){var n=new Date(e.getFullYear(),e.getMonth(),e.getDate()),i=n.getDay()-(t.options.weekStartOnMonday?1:0);return i<0&&(i=6),n.setDate(n.getDate()-i),n.getTime()}},month:{name:"month",level:50,maxItemNumber:12,defaultColumnNumber:12,defaultRowNumber:1,row:function(){return t.getSubDomainRowNumber()},column:function(){return t.getSubDomainColumnNumber()},position:{x:function(e){return Math.floor(e.getMonth()/t._domainType.month.row(e))},y:function(e){return e.getMonth()%t._domainType.month.row(e)}},format:{date:"%B %Y",legend:"%B",connector:"in"},extractUnit:function(t){return new Date(t.getFullYear(),t.getMonth()).getTime()}},year:{name:"year",level:60,row:function(){return t.options.rowLimit||1},column:function(){return t.options.colLimit||1},position:{x:function(){return 1},y:function(){return 1}},format:{date:"%Y",legend:"%Y",connector:"in"},extractUnit:function(t){return new Date(t.getFullYear()).getTime()}}},this._domainType)if(this._domainType.hasOwnProperty(e)){var n=this._domainType[e];this._domainType["x_"+e]={name:"x_"+e,level:n.type,maxItemNumber:n.maxItemNumber,defaultRowNumber:n.defaultRowNumber,defaultColumnNumber:n.defaultColumnNumber,row:n.column,column:n.row,position:{x:n.position.y,y:n.position.x},format:n.format,extractUnit:n.extractUnit}}function i(e,n){var i=t.options.cellSize*t._domainType[t.options.subDomain].column(e)+t.options.cellPadding*t._domainType[t.options.subDomain].column(e);return 2===arguments.length&&!0===n?i+(t.domainHorizontalLabelWidth+t.options.domainGutter+t.options.domainMargin[1]+t.options.domainMargin[3]):i}function o(e,n){var i=t.options.cellSize*t._domainType[t.options.subDomain].row(e)+t.options.cellPadding*t._domainType[t.options.subDomain].row(e);return 2===arguments.length&&!0===n&&(i+=t.options.domainGutter+t.domainVerticalLabelHeight+t.options.domainMargin[0]+t.options.domainMargin[2]),i}this.lastInsertedSvg=null,this._completed=!1,this._domains=a()(z).call(z),this.graphDim={width:0,height:0},this.legendDim={width:0,height:0},this.NAVIGATE_LEFT=1,this.NAVIGATE_RIGHT=2,this.RESET_ALL_ON_UPDATE=0,this.RESET_SINGLE_ON_UPDATE=1,this.APPEND_ON_UPDATE=2,this.DEFAULT_LEGEND_MARGIN=10,this.root=null,this.tooltip=null,this._maxDomainReached=!1,this._minDomainReached=!1,this.domainPosition=new V,this.Legend=null,this.legendScale=null,this.DSTDomain=[],this._init=function(){var e,n;return a()(e=a()(n=t.getDomain(t.options.start)).call(n,(function(t){return t.getTime()}))).call(e,(function(e){var n;t._domains.set(e,a()(n=t.getSubDomain(e)).call(n,(function(e){return{t:t._domainType[t.options.subDomain].extractUnit(e),v:null}})))})),t.root=z.select(t.options.itemSelector).append("svg").attr("class","cal-heatmap-container"),t.root.attr("x",0).attr("y",0).append("svg").attr("class","graph"),t.Legend=new G(t),t.options.paintOnLoad&&function(){t.verticalDomainLabel="top"===t.options.label.position||"bottom"===t.options.label.position,t.domainVerticalLabelHeight=null===t.options.label.height?Math.max(25,2*t.options.cellSize):t.options.label.height,t.domainHorizontalLabelWidth=0,""===t.options.domainLabelFormat&&null===t.options.label.height&&(t.domainVerticalLabelHeight=0);t.verticalDomainLabel||(t.domainVerticalLabelHeight=0,t.domainHorizontalLabelWidth=t.options.label.width);t.paint(),!1!==t.options.nextSelector&&z.select(t.options.nextSelector).on("click."+t.options.itemNamespace,(function(){return z.event.preventDefault(),t.loadNextDomain(1)}));!1!==t.options.previousSelector&&z.select(t.options.previousSelector).on("click."+t.options.itemNamespace,(function(){return z.event.preventDefault(),t.loadPreviousDomain(1)}));t.Legend.redraw(t.graphDim.width-t.options.domainGutter-t.options.cellPadding),t.afterLoad();var e=t.getDomainKeys();t.options.loadOnInit?t.getDatas(t.options.data,new Date(e[0]),t.getSubDomain(e[e.length-1]).pop(),(function(){Y()(t).call(t),t.onComplete()})):t.onComplete();t.checkIfMinDomainIsReached(e[0]),t.checkIfMaxDomainIsReached(t.getNextDomain().getTime())}(),t.root.call(t.tip),t.root.call(t.legendTip),!0},this.paint=function(e){var a=t.options;0===arguments.length&&(e=!1);var r=t.root.select(".graph").selectAll(".graph-domain").data((function(){var n=t.getDomainKeys();return e===t.NAVIGATE_LEFT?E()(n).call(n):n}),(function(t){return t})),s=0,l=0,u=r.enter().append("svg").attr("width",(function(t){return i(t,!0)})).attr("height",(function(t){return o(t,!0)})).attr("x",(function(e){return a.verticalOrientation?(t.graphDim.width=Math.max(t.graphDim.width,i(e,!0)),0):c(e,t.graphDim,"width",i(e,!0))})).attr("y",(function(e){return a.verticalOrientation?c(e,t.graphDim,"height",o(e,!0)):(t.graphDim.height=Math.max(t.graphDim.height,o(e,!0)),0)})).attr("class",(function(e){var n="graph-domain",i=new Date(e);switch(a.domain){case"hour":n+=" h_"+i.getHours();case"day":n+=" d_"+i.getDate()+" dy_"+i.getDay();case"week":n+=" w_"+t.getWeekNumber(i);case"month":n+=" m_"+(i.getMonth()+1);case"year":n+=" y_"+i.getFullYear()}return n}));function c(n,i,o,a){var r=0;switch(e){case!1:return r=i[o],i[o]+=a,t.domainPosition.setPosition(n,r),r;case t.NAVIGATE_RIGHT:return t.domainPosition.setPosition(n,i[o]),s=a,l=t.domainPosition.getPositionFromIndex(1),t.domainPosition.shiftRightBy(l),i[o];case t.NAVIGATE_LEFT:return s=-(r=-a),l=i[o]-t.domainPosition.getLast(),t.domainPosition.setPosition(n,r),t.domainPosition.shiftLeftBy(s),r}}t.lastInsertedSvg=u,u.append("rect").attr("width",(function(t){return i(t,!0)-a.domainGutter-a.cellPadding})).attr("height",(function(t){return o(t,!0)-a.domainGutter-a.cellPadding})).attr("class","domain-background");var h=u.append("svg").attr("x",(function(){return"left"===a.label.position?t.domainHorizontalLabelWidth+a.domainMargin[3]:a.domainMargin[3]})).attr("y",(function(){return"top"===a.label.position?t.domainVerticalLabelHeight+a.domainMargin[0]:a.domainMargin[0]})).attr("class","graph-subdomain-group"),m=h.selectAll("g").data((function(e){return t._domains.get(e)})).enter().append("g");function g(e){switch(a.label.rotate){case"right":e.attr("transform",(function(e){var n="rotate(90), ";switch(a.label.position){case"right":n+="translate(-"+i(e)+" , -"+i(e)+")";break;case"left":n+="translate(0, -"+t.domainHorizontalLabelWidth+")"}return n}));break;case"left":e.attr("transform",(function(e){var n="rotate(270), ";switch(a.label.position){case"right":n+="translate(-"+(i(e)+t.domainHorizontalLabelWidth)+" , "+i(e)+")";break;case"left":n+="translate(-"+t.domainHorizontalLabelWidth+" , "+t.domainHorizontalLabelWidth+")"}return n}))}}m.append("rect").attr("class",(function(e){return"graph-rect"+t.getHighlightClassName(e.t)+(null!==a.onClick?" hover_cursor":"")})).attr("width",a.cellSize).attr("height",a.cellSize).attr("x",(function(e){return t.positionSubDomainX(e.t)})).attr("y",(function(e){return t.positionSubDomainY(e.t)})).on("click",(function(e){if(null!==a.onClick)return t.onClick(new Date(e.t),e.v)})).call((function(e){a.cellRadius>0&&e.attr("rx",a.cellRadius).attr("ry",a.cellRadius),null!==t.legendScale&&null!==a.legendColors&&a.legendColors.hasOwnProperty("base")&&e.attr("fill",a.legendColors.base),a.tooltip&&e.on("mouseover",(function(e){t.tip.show(e,this)})).on("mouseout",(function(){t.tip.hide(n)}))})),a.tooltip||m.append("title").text((function(e){return t.formatDate(new Date(e.t),a.subDomainDateFormat)})),""!==a.domainLabelFormat&&u.append("text").attr("class","graph-label").attr("y",(function(e){var n=a.domainMargin[0];switch(a.label.position){case"top":n+=t.domainVerticalLabelHeight/2;break;case"bottom":n+=o(e)+t.domainVerticalLabelHeight/2}return n+a.label.offset.y*("right"===a.label.rotate&&"right"===a.label.position||"left"===a.label.rotate&&"left"===a.label.position?-1:1)})).attr("x",(function(e){var n=a.domainMargin[3];switch(a.label.position){case"right":n+=i(e);break;case"bottom":case"top":n+=i(e)/2}return"right"===a.label.align?n+t.domainHorizontalLabelWidth-a.label.offset.x*("right"===a.label.rotate?-1:1):n+a.label.offset.x})).attr("text-anchor",(function(){switch(a.label.align){case"start":case"left":return"start";case"end":case"right":return"end";default:return"middle"}})).attr("dominant-baseline",(function(){return t.verticalDomainLabel?"middle":"top"})).text((function(e){return t.formatDate(new Date(e),a.domainLabelFormat)})).call(g),null!==a.subDomainTextFormat&&m.append("text").attr("class",(function(e){return"subdomain-text"+t.getHighlightClassName(e.t)})).attr("x",(function(e){return t.positionSubDomainX(e.t)+a.cellSize/2})).attr("y",(function(e){return t.positionSubDomainY(e.t)+a.cellSize/2})).attr("text-anchor","middle").attr("dominant-baseline","central").text((function(e){return t.formatDate(new Date(e.t),a.subDomainTextFormat)})),!1!==e&&r.transition().duration(a.animationDuration).attr("x",(function(e){return a.verticalOrientation?0:t.domainPosition.getPosition(e)})).attr("y",(function(e){return a.verticalOrientation?t.domainPosition.getPosition(e):0}));var d=t.graphDim.width,p=t.graphDim.height;a.verticalOrientation?t.graphDim.height+=s-l:t.graphDim.width+=s-l,r.exit().transition().duration(a.animationDuration).attr("x",(function(n){if(a.verticalOrientation)return 0;switch(e){case t.NAVIGATE_LEFT:return Math.min(t.graphDim.width,d);case t.NAVIGATE_RIGHT:return-i(n,!0)}})).attr("y",(function(n){if(!a.verticalOrientation)return 0;switch(e){case t.NAVIGATE_LEFT:return Math.min(t.graphDim.height,p);case t.NAVIGATE_RIGHT:return-o(n,!0)}})).remove(),t.resize()}});U.prototype={init:function(t){var e,n=this,i=n.options=function t(e,n){for(var i in n)try{n[i].constructor===Object?e[i]=t(e[i],n[i]):e[i]=n[i]}catch(t){e[i]=n[i]}return e}(n.options,t);if(function(){if(!n._domainType.hasOwnProperty(i.domain)||"min"===i.domain||"x_"===i.domain.substring(0,2))throw new Error("The domain '"+i.domain+"' is not valid");if(!n._domainType.hasOwnProperty(i.subDomain)||"year"===i.subDomain)throw new Error("The subDomain '"+i.subDomain+"' is not valid");if(n._domainType[i.domain].level<=n._domainType[i.subDomain].level)throw new Error("'"+i.subDomain+"' is not a valid subDomain to '"+i.domain+"'")}(),s(i.itemSelector,!1,"itemSelector"),-1===I()(e=n.allowedDataType).call(e,i.dataType))throw new Error("The data type '"+i.dataType+"' is not valid data type");if(null===z.select(i.itemSelector)[0][0])throw new Error("The node '"+i.itemSelector+"' specified in itemSelector does not exists");try{s(i.nextSelector,!0,"nextSelector"),s(i.previousSelector,!0,"previousSelector")}catch(t){return console.log(t.message),!1}t.hasOwnProperty("subDomain")||(this.options.subDomain=function(t){switch(t){case"year":return"month";case"month":case"week":return"day";case"day":return"hour";default:return"min"}}(t.domain)),"string"==typeof i.itemNamespace&&""!==i.itemNamespace||(console.log("itemNamespace can not be empty, falling back to cal-heatmap"),i.itemNamespace="cal-heatmap");var o,a=["data","onComplete","onClick","afterLoad","afterLoadData","afterLoadPreviousDomain","afterLoadNextDomain","afterUpdate"];for(var r in a)t.hasOwnProperty(a[r])&&(i[a[r]]=t[a[r]]);function s(t,e,n){if((e&&!1===t||t instanceof Element||"string"==typeof t)&&""!==t)return!0;throw new Error("The "+n+" is not valid")}function l(t){switch("number"==typeof t&&(t=[t]),O()(t)||(console.log("Margin only takes an integer or an array of integers"),t=[0]),t.length){case 1:return[t[0],t[0],t[0],t[0]];case 2:return[t[0],t[1],t[0],t[1]];case 3:return[t[0],t[1],t[2],t[1]];case 4:return t;default:return P()(t).call(t,0,4)}}return i.subDomainDateFormat="string"==typeof i.subDomainDateFormat||"function"==typeof i.subDomainDateFormat?i.subDomainDateFormat:this._domainType[i.subDomain].format.date,i.domainLabelFormat="string"==typeof i.domainLabelFormat||"function"==typeof i.domainLabelFormat?i.domainLabelFormat:this._domainType[i.domain].format.legend,i.subDomainTextFormat="string"==typeof i.subDomainTextFormat&&""!==i.subDomainTextFormat||"function"==typeof i.subDomainTextFormat?i.subDomainTextFormat:null,i.domainMargin=l(i.domainMargin),i.legendMargin=l(i.legendMargin),i.highlight=n.expandDateSetting(i.highlight),i.itemName=function(t){if("string"==typeof t)return[t,t+(""!==t?"s":"")];if(O()(t))return 1===t.length?[t[0],t[0]+"s"]:t.length>2?P()(t).call(t,0,2):t;return["item","items"]}(i.itemName),i.colLimit=(o=i.colLimit)>0?o:null,i.rowLimit=function(t){if(t>0&&i.colLimit>0)return console.log("colLimit and rowLimit are mutually exclusive, rowLimit will be ignored"),null;return t>0?t:null}(i.rowLimit),t.hasOwnProperty("legendMargin")||function(){switch(i.legendVerticalPosition){case"top":i.legendMargin[2]=n.DEFAULT_LEGEND_MARGIN;break;case"bottom":i.legendMargin[0]=n.DEFAULT_LEGEND_MARGIN;break;case"middle":case"center":i.legendMargin["right"===i.legendHorizontalPosition?3:1]=n.DEFAULT_LEGEND_MARGIN}}(),function(){if(!t.hasOwnProperty("label")||t.hasOwnProperty("label")&&!t.label.hasOwnProperty("align")){switch(i.label.position){case"left":i.label.align="right";break;case"right":i.label.align="left";break;default:i.label.align="center"}"left"===i.label.rotate?i.label.align="right":"right"===i.label.rotate&&(i.label.align="left")}(!t.hasOwnProperty("label")||t.hasOwnProperty("label")&&!t.label.hasOwnProperty("offset"))&&("left"!==i.label.position&&"right"!==i.label.position||(i.label.offset={x:10,y:15}))}(),this._init()},expandDateSetting:function(t){var e;return O()(t)||(t=[t]),_()(e=a()(t).call(t,(function(t){return"now"===t?new Date:t instanceof Date&&t}))).call(e,(function(t){return!1!==t}))},fill:function(t){var e=this,n=e.options;0===arguments.length&&(t=e.root.selectAll(".graph-domain"));var i=t.selectAll("svg").selectAll("g").data((function(t){return e._domains.get(t)}));function o(t){if(null===e.legendScale)return!1;t.attr("fill",(function(t){return null===t.v&&n.hasOwnProperty("considerMissingDataAsZero")&&!n.considerMissingDataAsZero&&n.legendColors.hasOwnProperty("base")?n.legendColors.base:null!==n.legendColors&&n.legendColors.hasOwnProperty("empty")&&(0===t.v||null===t.v&&n.hasOwnProperty("considerMissingDataAsZero")&&n.considerMissingDataAsZero)?n.legendColors.empty:t.v<0&&n.legend[0]>0&&null!==n.legendColors&&n.legendColors.hasOwnProperty("overflow")?n.legendColors.overflow:e.legendScale(Math.min(t.v,n.legend[n.legend.length-1]))}))}function a(t){"function"==typeof n.subDomainTextFormat&&t.text((function(t){return n.subDomainTextFormat(t.t,t.v)}))}i.transition().duration(n.animationDuration).select("rect").attr("class",(function(t){var i,o=L()(i=e.getHighlightClassName(t.t)).call(i).split(" "),a=e.dateIsLessThan(t.t,new Date),r=e.dateIsEqual(t.t,new Date);return(null===e.legendScale||null===t.v&&n.hasOwnProperty("considerMissingDataAsZero")&&!n.considerMissingDataAsZero&&!n.legendColors.hasOwnProperty("base"))&&o.push("graph-rect"),r?o.push("now"):a||o.push("future"),null!==t.v?o.push(e.Legend.getClass(t.v,null===e.legendScale)):n.considerMissingDataAsZero&&a&&o.push(e.Legend.getClass(0,null===e.legendScale)),null!==n.onClick&&o.push("hover_cursor"),o.join(" ")})).call(o),i.transition().duration(n.animationDuration).select("title").text((function(t){return e.getSubDomainTitle(t)})),i.transition().duration(n.animationDuration).select("text").attr("class",(function(t){return"subdomain-text"+e.getHighlightClassName(t.t)})).call(a)},formatStringWithObject:function(t,e){for(var n in e)if(e.hasOwnProperty(n)){var i=new RegExp("\\{"+n+"\\}","gi");t=t.replace(i,e[n])}return t},triggerEvent:function(t,e,n){return!!(3===arguments.length&&n||null===this.options[t])||("function"==typeof this.options[t]?("function"==typeof e&&(e=e()),this.options[t].apply(this,e)):(console.log("Provided callback for "+t+" is not a function."),!1))},onClick:function(t,e){return this.triggerEvent("onClick",[t,e])},afterLoad:function(){return this.triggerEvent("afterLoad")},onComplete:function(){var t=this.triggerEvent("onComplete",[],this._completed);return this._completed=!0,t},afterLoadPreviousDomain:function(t){var e=this;return this.triggerEvent("afterLoadPreviousDomain",(function(){var n=e.getSubDomain(t);return[n.shift(),n.pop()]}))},afterLoadNextDomain:function(t){var e=this;return this.triggerEvent("afterLoadNextDomain",(function(){var n=e.getSubDomain(t);return[n.shift(),n.pop()]}))},onMinDomainReached:function(t){return this._minDomainReached=t,this.triggerEvent("onMinDomainReached",[t])},onMaxDomainReached:function(t){return this._maxDomainReached=t,this.triggerEvent("onMaxDomainReached",[t])},checkIfMinDomainIsReached:function(t,e){this.minDomainIsReached(t)&&this.onMinDomainReached(!0),2===arguments.length&&this._maxDomainReached&&!this.maxDomainIsReached(e)&&this.onMaxDomainReached(!1)},checkIfMaxDomainIsReached:function(t,e){this.maxDomainIsReached(t)&&this.onMaxDomainReached(!0),2===arguments.length&&this._minDomainReached&&!this.minDomainIsReached(e)&&this.onMinDomainReached(!1)},afterUpdate:function(){return this.triggerEvent("afterUpdate")},formatNumber:z.format(",g"),formatDate:function(t,e){if(arguments.length<2&&(e="title"),"function"==typeof e)return e(t);var n=z.time.format(e);return n(t)},getSubDomainTitle:function(t){if(null!==t.v||this.options.considerMissingDataAsZero){var e=t.v;return null===e&&this.options.considerMissingDataAsZero&&(e=0),this.formatStringWithObject(this.options.subDomainTitleFormat.filled,{count:this.formatNumber(e),name:this.options.itemName[1!==e?1:0],connector:this._domainType[this.options.subDomain].format.connector,date:this.formatDate(new Date(t.t),this.options.subDomainDateFormat)})}return this.formatStringWithObject(this.options.subDomainTitleFormat.empty,{date:this.formatDate(new Date(t.t),this.options.subDomainDateFormat)})},loadNextDomain:function(t){if(this._maxDomainReached||0===t)return!1;var e=this.loadNewDomains(this.NAVIGATE_RIGHT,this.getDomain(this.getNextDomain(),t));return this.afterLoadNextDomain(e.end),this.checkIfMaxDomainIsReached(this.getNextDomain().getTime(),e.start),!0},loadPreviousDomain:function(t){var e;if(this._minDomainReached||0===t)return!1;var n=this.loadNewDomains(this.NAVIGATE_LEFT,E()(e=this.getDomain(this.getDomainKeys()[0],-t)).call(e));return this.afterLoadPreviousDomain(n.start),this.checkIfMinDomainIsReached(n.start,n.end),!0},loadNewDomains:function(t,e){var n=this,i=t===this.NAVIGATE_LEFT,o=-1,r=e.length,s=this.getDomainKeys();function l(t){return{t:n._domainType[n.options.subDomain].extractUnit(t),v:null}}for(;++o<r;){if(i&&this.minDomainIsReached(e[o])){e=P()(e).call(e,0,o+1);break}if(!i&&this.maxDomainIsReached(e[o])){e=P()(e).call(e,0,o);break}}for(o=0,r=(e=P()(e).call(e,-this.options.range)).length;o<r;o++){var u;this._domains.set(e[o].getTime(),a()(u=this.getSubDomain(e[o])).call(u,l)),this._domains.remove(i?s.pop():s.shift())}return s=this.getDomainKeys(),i&&(e=E()(e).call(e)),this.paint(t),this.getDatas(this.options.data,e[0],this.getSubDomain(e[e.length-1]).pop(),(function(){Y()(n).call(n,n.lastInsertedSvg)})),{start:e[i?0:1],end:s[s.length-1]}},maxDomainIsReached:function(t){return null!==this.options.maxDate&&this.options.maxDate.getTime()<t},minDomainIsReached:function(t){return null!==this.options.minDate&&this.options.minDate.getTime()>=t},getDomainKeys:function(){var t,e,n;return N()(t=a()(e=M()(n=this._domains).call(n)).call(e,(function(t){return v()(t,10)}))).call(t,(function(t,e){return t-e}))},positionSubDomainX:function(t){var e=this._domainType[this.options.subDomain].position.x(new Date(t));return e*this.options.cellSize+e*this.options.cellPadding},positionSubDomainY:function(t){var e=this._domainType[this.options.subDomain].position.y(new Date(t));return e*this.options.cellSize+e*this.options.cellPadding},getSubDomainColumnNumber:function(t){if(this.options.rowLimit>0){var e=this._domainType[this.options.subDomain].maxItemNumber;return"function"==typeof e&&(e=e(t)),Math.ceil(e/this.options.rowLimit)}var n=this._domainType[this.options.subDomain].defaultColumnNumber;return"function"==typeof n&&(n=n(t)),this.options.colLimit||n},getSubDomainRowNumber:function(t){if(this.options.colLimit>0){var e=this._domainType[this.options.subDomain].maxItemNumber;return"function"==typeof e&&(e=e(t)),Math.ceil(e/this.options.colLimit)}var n=this._domainType[this.options.subDomain].defaultRowNumber;return"function"==typeof n&&(n=n(t)),this.options.rowLimit||n},getHighlightClassName:function(t){if(t=new Date(t),this.options.highlight.length>0)for(var e in this.options.highlight)if(this.dateIsEqual(this.options.highlight[e],t))return this.isNow(this.options.highlight[e])?" highlight-now":" highlight";return""},isNow:function(t){return this.dateIsEqual(t,new Date)},dateIsEqual:function(t,e){switch(t instanceof Date||(t=new Date(t)),e instanceof Date||(e=new Date(e)),this.options.subDomain){case"x_min":case"min":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours()&&t.getMinutes()===e.getMinutes();case"x_hour":case"hour":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate()&&t.getHours()===e.getHours();case"x_day":case"day":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate();case"x_week":case"week":return t.getFullYear()===e.getFullYear()&&this.getWeekNumber(t)===this.getWeekNumber(e);case"x_month":case"month":return t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth();default:return!1}},dateIsLessThan:function(t,e){function n(t,e){switch(e){case"x_min":case"min":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes()).getTime();case"x_hour":case"hour":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()).getTime();case"x_day":case"day":return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime();case"x_week":case"week":case"x_month":case"month":return new Date(t.getFullYear(),t.getMonth()).getTime();default:return t.getTime()}}return t instanceof Date||(t=new Date(t)),e instanceof Date||(e=new Date(e)),n(t,this.options.subDomain)<n(e,this.options.subDomain)},getDayOfYear:z.time.format("%j"),getWeekNumber:function(t){return(!0===this.options.weekStartOnMonday?z.time.format("%W"):z.time.format("%U"))(t)},getMonthWeekNumber:function(t){"number"==typeof t&&(t=new Date(t));var e=this.getWeekNumber(new Date(t.getFullYear(),t.getMonth()));return this.getWeekNumber(t)-e-1},getWeekNumberInYear:function(t){"number"==typeof t&&(t=new Date(t))},getDayCountInMonth:function(t){return this.getEndOfMonth(t).getDate()},getDayCountInYear:function(t){return"number"==typeof t&&(t=new Date(t)),1===new Date(t.getFullYear(),1,29).getMonth()?366:365},getWeekDay:function(t){return!1===this.options.weekStartOnMonday?t.getDay():0===t.getDay()?6:t.getDay()-1},getEndOfMonth:function(t){return"number"==typeof t&&(t=new Date(t)),new Date(t.getFullYear(),t.getMonth()+1,0)},jumpDate:function(t,e,n){var i=new Date(t);switch(n){case"hour":i.setHours(i.getHours()+e);break;case"day":i.setHours(i.getHours()+24*e);break;case"week":i.setHours(i.getHours()+24*e*7);break;case"month":i.setMonth(i.getMonth()+e);break;case"year":i.setFullYear(i.getFullYear()+e)}return new Date(i)},getMinuteDomain:function(t,e){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()),i=null;return i=e instanceof Date?new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()):new Date(+n+1e3*e*60),z.time.minutes(Math.min(n,i),Math.max(n,i))},getHourDomain:function(t,e){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours()),i=null;e instanceof Date?i=new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours()):(i=new Date(n)).setHours(i.getHours()+e);var o=z.time.hours(Math.min(n,i),Math.max(n,i)),a=0,r=o.length;for(a=0;a<r;a++)if(a>0&&o[a].getHours()===o[a-1].getHours()){this.DSTDomain.push(o[a].getTime()),w()(o).call(o,a,1);break}return"number"==typeof e&&o.length>Math.abs(e)&&w()(o).call(o,o.length-1,1),o},getDayDomain:function(t,e){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),i=null;return e instanceof Date?i=new Date(e.getFullYear(),e.getMonth(),e.getDate()):(i=new Date(n),i=new Date(i.setDate(i.getDate()+v()(e,10)))),z.time.days(Math.min(n,i),Math.max(n,i))},getWeekDomain:function(t,e){var n;!1===this.options.weekStartOnMonday?n=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()):1===t.getDay()?n=new Date(t.getFullYear(),t.getMonth(),t.getDate()):0===t.getDay()?(n=new Date(t.getFullYear(),t.getMonth(),t.getDate())).setDate(n.getDate()-6):n=new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay()+1);var i=new Date(n),o=e;return"object"!=typeof e&&(o=new Date(i.setDate(i.getDate()+7*e))),!0===this.options.weekStartOnMonday?z.time.mondays(Math.min(n,o),Math.max(n,o)):z.time.sundays(Math.min(n,o),Math.max(n,o))},getMonthDomain:function(t,e){var n=new Date(t.getFullYear(),t.getMonth()),i=null;return i=e instanceof Date?new Date(e.getFullYear(),e.getMonth()):(i=new Date(n)).setMonth(i.getMonth()+e),z.time.months(Math.min(n,i),Math.max(n,i))},getYearDomain:function(t,e){var n=new Date(t.getFullYear(),0),i=null;return i=e instanceof Date?new Date(e.getFullYear(),0):new Date(t.getFullYear()+e,0),z.time.years(Math.min(n,i),Math.max(n,i))},getDomain:function(t,e){switch("number"==typeof t&&(t=new Date(t)),arguments.length<2&&(e=this.options.range),this.options.domain){case"hour":var n=this.getHourDomain(t,e);return"number"==typeof e&&n.length<e&&(e>0?n.push(this.getHourDomain(n[n.length-1],2)[1]):n.shift(this.getHourDomain(n[0],-2)[0])),n;case"day":return this.getDayDomain(t,e);case"week":return this.getWeekDomain(t,e);case"month":return this.getMonthDomain(t,e);case"year":return this.getYearDomain(t,e)}},getSubDomain:function(t){"number"==typeof t&&(t=new Date(t));var e=this;switch(this.options.subDomain){case"x_min":case"min":return this.getMinuteDomain(t,function(t,e){switch(e){case"hour":return 60;case"day":return 1440;case"week":return 10080}}(0,this.options.domain));case"x_hour":case"hour":return this.getHourDomain(t,function(t,n){switch(n){case"day":return 24;case"week":return 168;case"month":return 24*e.getDayCountInMonth(t)}}(t,this.options.domain));case"x_day":case"day":return this.getDayDomain(t,function(t,n){switch(n){case"year":return e.getDayCountInYear(t);case"month":return e.getDayCountInMonth(t);case"week":return 7}}(t,this.options.domain));case"x_week":case"week":return this.getWeekDomain(t,function(t,n){if("month"===n){var i=new Date(t.getFullYear(),t.getMonth()+1,0),o=e.getWeekNumber(i),a=e.getWeekNumber(new Date(t.getFullYear(),t.getMonth()));return a>o&&(a=0,o++),o-a+1}if("year"===n)return e.getWeekNumber(new Date(t.getFullYear(),11,31))}(t,this.options.domain));case"x_month":case"month":return this.getMonthDomain(t,12)}},getNextDomain:function(t){return 0===arguments.length&&(t=1),this.getDomain(this.jumpDate(this.getDomainKeys().pop(),t,this.options.domain),1)[0]},getPreviousDomain:function(t){return 0===arguments.length&&(t=1),this.getDomain(this.jumpDate(this.getDomainKeys().shift(),-t,this.options.domain),1)[0]},getDatas:function(t,e,n,i,o,a){var r=this;arguments.length<5&&(o=!0),arguments.length<6&&(a=this.APPEND_ON_UPDATE);var s=function(t,s){!1!==o?"function"==typeof o?s=o(s):"function"==typeof r.options.afterLoadData?s=r.options.afterLoadData(s):console.log("Provided callback for afterLoadData is not a function."):"csv"!==r.options.dataType&&"tsv"!==r.options.dataType||(s=this.interpretCSV(s)),r.parseDatas(s,a,e,n),"function"==typeof i&&i()};switch(typeof t){case"string":if(""===t)return s(null,{}),!0;var l=this.parseURI(t,e,n),u="GET";null!==r.options.dataPostPayload&&(u="POST");var c=null;null!==r.options.dataPostPayload&&(c=this.parseURI(r.options.dataPostPayload,e,n));var h=null;switch(this.options.dataType){case"json":h=z.json(l);break;case"csv":h=z.csv(l);break;case"tsv":h=z.tsv(l);break;case"txt":h=z.text(l,"text/plain")}if(null!==r.options.dataRequestHeaders)for(var m in r.options.dataRequestHeaders)r.options.dataRequestHeaders.hasOwnProperty(m)&&h.header(m,r.options.dataRequestHeaders[m]);return h.send(u,c,s),!1;case"object":if(t===Object(t))return s(null,t),!1;default:return s(null,{}),!0}},parseDatas:function(t,e,n,i){var o;e===this.RESET_ALL_ON_UPDATE&&u()(o=this._domains).call(o,(function(t,e){u()(e).call(e,(function(t,e,n){n[e].v=null}))}));var r={},s=function(t){return t.t};for(var l in t){var c,h,m=new Date(1e3*l),g=this.getDomain(m)[0].getTime();if(I()(c=this.DSTDomain).call(c,g)>=0&&this._domains.has(g-36e5)&&(g-=36e5),!isNaN(l)&&t.hasOwnProperty(l)&&this._domains.has(g)&&g>=+n&&g<+i){var d=this._domains.get(g);r.hasOwnProperty(g)||(r[g]=a()(d).call(d,s));var p=I()(h=r[g]).call(h,this._domainType[this.options.subDomain].extractUnit(m));e===this.RESET_SINGLE_ON_UPDATE?d[p].v=t[l]:isNaN(d[p].v)?d[p].v=t[l]:d[p].v+=t[l]}}},parseURI:function(t,e,n){return t=(t=(t=(t=t.replace(/\{\{t:start\}\}/g,e.getTime()/1e3)).replace(/\{\{t:end\}\}/g,n.getTime()/1e3)).replace(/\{\{d:start\}\}/g,e.toISOString())).replace(/\{\{d:end\}\}/g,n.toISOString())},interpretCSV:function(t){var e,n,i={},o=s()(t[0]);for(e=0,n=t.length;e<n;e++)i[t[e][o[0]]]=+t[e][o[1]];return i},resize:function(){var t=this.options,e=t.displayLegend?this.Legend.getDim("width")+t.legendMargin[1]+t.legendMargin[3]:0,n=t.displayLegend?this.Legend.getDim("height")+t.legendMargin[0]+t.legendMargin[2]:0,i=this.graphDim.width-t.domainGutter-t.cellPadding,o=this.graphDim.height-t.domainGutter-t.cellPadding;this.root.transition().duration(t.animationDuration).attr("width",(function(){return"middle"===t.legendVerticalPosition||"center"===t.legendVerticalPosition?i+e:Math.max(i,e)})).attr("height",(function(){return"middle"===t.legendVerticalPosition||"center"===t.legendVerticalPosition?Math.max(o,n):o+n})),this.root.select(".graph").transition().duration(t.animationDuration).attr("y",(function(){return"top"===t.legendVerticalPosition?n:0})).attr("x",(function(){return"middle"!==t.legendVerticalPosition&&"center"!==t.legendVerticalPosition||"left"!==t.legendHorizontalPosition?0:e}))},next:function(t){return 0===arguments.length&&(t=1),this.loadNextDomain(t)},previous:function(t){return 0===arguments.length&&(t=1),this.loadPreviousDomain(t)},jumpTo:function(t,e){arguments.length<2&&(e=!1);var n=this.getDomainKeys(),i=n[0],o=n[n.length-1];return t<i?this.loadPreviousDomain(this.getDomain(i,t).length):e?this.loadNextDomain(this.getDomain(i,t).length):t>o&&this.loadNextDomain(this.getDomain(o,t).length)},rewind:function(){this.jumpTo(this.options.start,!0)},update:function(t,e,n){0===arguments.length&&(t=this.options.data),arguments.length<2&&(e=!0),arguments.length<3&&(n=this.RESET_ALL_ON_UPDATE);var i=this.getDomainKeys(),o=this;this.getDatas(t,new Date(i[0]),this.getSubDomain(i[i.length-1]).pop(),(function(){Y()(o).call(o),o.afterUpdate()}),e,n)},setLegend:function(){var t,e,n=P()(t=this.options.legend).call(t,0);(arguments.length>=1&&O()(arguments[0])&&(this.options.legend=arguments[0]),arguments.length>=2&&(O()(arguments[1])&&arguments[1].length>=2?this.options.legendColors=[arguments[1][0],arguments[1][1]]:this.options.legendColors=arguments[1]),arguments.length>0&&!j(n,this.options.legend)||arguments.length>=2)&&(this.Legend.buildColors(),Y()(e=this).call(e));this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding)},removeLegend:function(){return!!this.options.displayLegend&&(this.options.displayLegend=!1,this.Legend.remove(),!0)},showLegend:function(){return!this.options.displayLegend&&(this.options.displayLegend=!0,this.Legend.redraw(this.graphDim.width-this.options.domainGutter-this.options.cellPadding),!0)},highlight:function(t){var e;return(this.options.highlight=this.expandDateSetting(t)).length>0&&(Y()(e=this).call(e),!0)},destroy:function(t){return this.root.transition().duration(this.options.animationDuration).attr("width",0).attr("height",0).remove().each("end",(function(){"function"==typeof t?t():void 0!==t&&console.log("Provided callback for destroy() is not a function.")})),null},getSVG:function(){for(var t={".cal-heatmap-container":{},".graph":{},".graph-rect":{},"rect.highlight":{},"rect.now":{},"rect.highlight-now":{},"text.highlight":{},"text.now":{},"text.highlight-now":{},".domain-background":{},".graph-label":{},".subdomain-text":{},".q0":{},".qi":{}},e=1,n=this.options.legend.length+1;e<=n;e++)t[".q"+e]={};var i,o=this.root,a=["stroke","stroke-width","stroke-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-miterlimit","fill","fill-opacity","fill-rule","marker","marker-start","marker-mid","marker-end","alignement-baseline","baseline-shift","dominant-baseline","glyph-orientation-horizontal","glyph-orientation-vertical","kerning","text-anchor","shape-rendering","text-transform","font-family","font","font-size","font-weight"],r=function(e,n,i){-1!==I()(a).call(a,n)&&(t[e][n]=i)};for(var s in t)if(t.hasOwnProperty(s)){var l=(i=s,o.select(i)[0][0]);if(null!==l)if("getComputedStyle"in window){var u=getComputedStyle(l,null);if(0!==u.length)for(var c=0;c<u.length;c++)r(s,u.item(c),u.getPropertyValue(u.item(c)));else for(var h in u)u.hasOwnProperty(h)&&r(s,h,u[h])}else if("currentStyle"in l){var m=l.currentStyle;for(var g in m)r(s,g,m[g])}}var d='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><style type="text/css"><![CDATA[ ';for(var p in t){for(var f in d+=p+" {\n",t[p])d+="\t"+f+":"+t[p][f]+";\n";d+="}\n"}return d+="]]></style>",d+=(new XMLSerializer).serializeToString(this.root[0][0]),d+="</svg>"}};var V=function(){this.positions=a()(z).call(z)};V.prototype.getPosition=function(t){return this.positions.get(t)},V.prototype.getPositionFromIndex=function(t){var e=this.getKeys();return this.positions.get(e[t])},V.prototype.getLast=function(){var t=this.getKeys();return this.positions.get(t[t.length-1])},V.prototype.setPosition=function(t,e){this.positions.set(t,e)},V.prototype.shiftRightBy=function(t){var e;u()(e=this.positions).call(e,(function(e,n){this.set(e,n-t)}));var n=this.getKeys();this.positions.remove(n[0])},V.prototype.shiftLeftBy=function(t){var e;u()(e=this.positions).call(e,(function(e,n){this.set(e,n+t)}));var n=this.getKeys();this.positions.remove(n[n.length-1])},V.prototype.getKeys=function(){var t,e;return N()(t=M()(e=this.positions).call(e)).call(t,(function(t,e){return v()(t,10)-v()(e,10)}))};var G=function(t){this.calendar=t,this.computeDim(),null!==t.options.legendColors&&this.buildColors()};function j(t,e){if(!e||!t)return!1;if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]instanceof Array&&e[n]instanceof Array){if(!j(t[n],e[n]))return!1}else if(t[n]!==e[n])return!1;return!0}G.prototype.computeDim=function(){var t=this.calendar.options;this.dim={width:t.legendCellSize*(t.legend.length+1)+t.legendCellPadding*t.legend.length,height:t.legendCellSize}},G.prototype.remove=function(){this.calendar.root.select(".graph-legend").remove(),this.calendar.resize()},G.prototype.redraw=function(t){var e;if(!this.calendar.options.displayLegend)return!1;var n,i=this,o=this.calendar,a=o.root,r=o.options;this.computeDim();var s=P()(e=r.legend).call(e,0);s.push(s[s.length-1]+1);var l=o.root.select(".graph-legend");function u(t){t.attr("width",r.legendCellSize).attr("height",r.legendCellSize).attr("rx",r.legendCellRadius).attr("ry",r.legendCellRadius).attr("x",(function(t,e){return e*(r.legendCellSize+r.legendCellPadding)}))}function c(){switch(r.legendHorizontalPosition){case"right":return"center"===r.legendVerticalPosition||"middle"===r.legendVerticalPosition?t+r.legendMargin[3]:t-i.getDim("width")-r.legendMargin[1];case"middle":case"center":return Math.round(t/2-i.getDim("width")/2);default:return r.legendMargin[3]}}function h(){return"bottom"===r.legendVerticalPosition?o.graphDim.height+r.legendMargin[0]-r.domainGutter-r.cellPadding:r.legendMargin[0]}null!==l[0][0]?n=(a=l).select("g").selectAll("rect").data(s):((a="top"===r.legendVerticalPosition?a.insert("svg",".graph"):a.append("svg")).attr("x",c()).attr("y",h()),n=a.attr("class","graph-legend").attr("height",i.getDim("height")).attr("width",i.getDim("width")).append("g").selectAll().data(s)),n.enter().append("rect").call(u).attr("class",(function(t){return o.Legend.getClass(t,null===o.legendScale)})).attr("fill-opacity",0).call((function(t){null!==o.legendScale&&null!==r.legendColors&&r.legendColors.hasOwnProperty("base")&&t.attr("fill",r.legendColors.base)})).append("title"),n.exit().transition().duration(r.animationDuration).attr("fill-opacity",0).remove(),n.transition().delay((function(t,e){return r.animationDuration*e/10})).call(u).attr("fill-opacity",1).call((function(t){t.attr("fill",(function(t,e){return null===o.legendScale?"":0===e?o.legendScale(t-1):o.legendScale(r.legend[e-1])})),t.attr("class",(function(t){return o.Legend.getClass(t,null===o.legendScale)}))})),n.select("title").text((function(t,e){return 0===e?o.formatStringWithObject(r.legendTitleFormat.lower,{min:r.legend[e],name:r.itemName[1]}):e===s.length-1?o.formatStringWithObject(r.legendTitleFormat.upper,{max:r.legend[e-1],name:r.itemName[1]}):o.formatStringWithObject(r.legendTitleFormat.inner,{down:r.legend[e-1],up:r.legend[e],name:r.itemName[1]})})),n.on("mouseover",(function(t){o.legendTip.show(t,this)})).on("mouseout",(function(){o.legendTip.hide()})),a.transition().duration(r.animationDuration).attr("x",c()).attr("y",h()).attr("width",i.getDim("width")).attr("height",i.getDim("height")),a.select("g").transition().duration(r.animationDuration).attr("transform",(function(){return"vertical"===r.legendOrientation?"rotate(90 "+r.legendCellSize/2+" "+r.legendCellSize/2+")":""})),o.resize()},G.prototype.getDim=function(t){var e="horizontal"===this.calendar.options.legendOrientation;switch(t){case"width":return this.dim[e?"width":"height"];case"height":return this.dim[e?"height":"width"]}},G.prototype.buildColors=function(){var t,e=this.calendar.options;if(null===e.legendColors)return this.calendar.legendScale=null,!1;var n=[];if(O()(e.legendColors))n=e.legendColors;else{if(!e.legendColors.hasOwnProperty("min")||!e.legendColors.hasOwnProperty("max"))return e.legendColors=null,!1;n=[e.legendColors.min,e.legendColors.max]}var i,o=P()(t=e.legend).call(t,0);o[0]>0?o.unshift(0):o[0]<=0&&o.unshift(o[0]-(o[o.length-1]-o[0])/o.length),i=e.legendColors.hasOwnProperty("colorScale")?e.legendColors.colorScale:z.scale.linear().range(n).interpolate(z.interpolateHcl).domain([z.min(o),z.max(o)]);var r=a()(o).call(o,(function(t){return i(t)}));return this.calendar.legendScale=z.scale.threshold().domain(e.legend).range(r),!0},G.prototype.getClass=function(t,e){var n;if(null===t||isNaN(t))return"";for(var i=[this.calendar.options.legend.length+1],o=0,a=this.calendar.options.legend.length-1;o<=a;o++){if(this.calendar.options.legend[0]>0&&t<0){i=["1","i"];break}if(t<=this.calendar.options.legend[o]){i=[o+1];break}}return 0===t&&i.push(0),i.unshift(""),L()(n=i.join(" r")+(e?i.join(" q"):"")).call(n)};var q=U;n(1643),n(1645);var B=function(t){return(e=new Date(t),new Date(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds())).getTime();var e},K={data:h.a.shape({data:h.a.object,domain:h.a.string,range:h.a.number,start:h.a.number,subdomain:h.a.string}),height:h.a.number,cellPadding:h.a.number,cellRadius:h.a.number,cellSize:h.a.number,linearColorScheme:h.a.string,showLegend:h.a.bool,showMetricName:h.a.bool,showValues:h.a.bool,steps:h.a.number,timeFormat:h.a.string,valueFormat:h.a.string,verboseMap:h.a.object};function Z(t,e){var n,i,o=e.data,r=e.height,l=e.cellPadding,c=void 0===l?3:l,h=e.cellRadius,b=void 0===h?0:h,w=e.cellSize,y=void 0===w?10:w,v=e.linearColorScheme,x=e.showLegend,M=e.showMetricName,T=e.showValues,N=e.steps,S=e.timeFormat,L=e.valueFormat,k=e.verboseMap,_=Object(f.b)(L),C=Object(D.b)(S),P=Object(d.a)(t).classed("superset-legacy-chart-calendar",!0).style("height",r);P.selectAll("*").remove();var F=P.append("div"),O=T?function(t,e){return _(e)}:null,A={};u()(n=s()(o.data)).call(n,(function(t){var e;A[t]={},u()(e=s()(o.data[t])).call(e,(function(e){A[t][B(1e3*e)/1e3]=o.data[t][e]}))})),u()(i=s()(A)).call(i,(function(t){var e,n=F.append("div");M&&n.text("Metric: "+(k[t]||t));var i=A[t],r=Object(m.a)(s()(i),(function(t){return i[t]})),l=(r[1]-r[0])/(N-1),u=Object(p.a)().get(v).createLinearScale(r),h=a()(e=Object(g.a)(N)).call(e,(function(t){return r[0]+l*t})),d=a()(h).call(h,(function(t){return u(t)}));(new q).init({start:B(o.start),data:i,itemSelector:n.node(),legendVerticalPosition:"top",cellSize:y,cellPadding:c,cellRadius:b,legendCellSize:y,legendCellPadding:2,legendCellRadius:b,tooltip:!0,domain:o.domain,subDomain:o.subdomain,range:o.range,browsing:!0,legend:h,legendColors:{colorScale:u,min:d[0],max:d[d.length-1],empty:"white"},displayLegend:x,itemName:"",valueFormatter:_,timeFormatter:C,subDomainTextFormat:O})}))}Z.displayName="Calendar",Z.propTypes=K;var X=Z;e.default=Object(i.a)(X)}}]);